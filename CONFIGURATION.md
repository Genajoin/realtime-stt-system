# Конфигурация STT сервера

## Обзор

STT сервер использует переменные окружения для конфигурации. Файл `.env` не является обязательным - все параметры имеют разумные значения по умолчанию.

## Быстрый старт

1. **Без конфигурации** (используются значения по умолчанию):
   ```bash
   docker compose up -d
   ```

2. **С пользовательской конфигурацией**:
   ```bash
   cp .env.example .env
   # Отредактируйте .env файл по необходимости
   docker compose up -d
   ```

## Параметры конфигурации

### Основные параметры модели

| Переменная | Значение по умолчанию | Описание |
|------------|----------------------|----------|
| `WHISPER_MODEL` | `medium` | Модель Whisper: tiny, base, small, medium, large |
| `LANGUAGE` | `ru` | Язык распознавания: ru, en, etc. |
| `REALTIME_MODEL_TYPE` | `tiny` | Модель для real-time: tiny, base, small |
| `DEVICE` | `cuda` | Устройство вычислений: cuda, cpu |

### Настройки транскрипции

| Переменная | Значение по умолчанию | Описание |
|------------|----------------------|----------|
| `ENABLE_REALTIME_TRANSCRIPTION` | `true` | Включить real-time транскрипцию |
| `SILERO_USE_ONNX` | `true` | Использовать ONNX версию Silero VAD |

### Настройки VAD (Voice Activity Detection)

| Переменная | Значение по умолчанию | Описание |
|------------|----------------------|----------|
| `SILERO_SENSITIVITY` | `0.05` | Чувствительность Silero VAD (0.0 - 1.0) |
| `WEBRTC_SENSITIVITY` | `3` | Чувствительность WebRTC VAD (1-4) |
| `POST_SPEECH_SILENCE_DURATION` | `0.7` | Длительность тишины после речи (сек) |
| `MIN_LENGTH_OF_RECORDING` | `1.1` | Минимальная длительность записи (сек) |

### Настройки качества распознавания

| Переменная | Значение по умолчанию | Описание |
|------------|----------------------|----------|
| `BEAM_SIZE` | `5` | Размер beam search для полной транскрипции |
| `BEAM_SIZE_REALTIME` | `3` | Размер beam search для real-time |
| `REALTIME_PROCESSING_PAUSE` | `0.02` | Пауза между обработкой real-time (сек) |
| `INITIAL_PROMPT` | См. .env.example | Начальный промпт для модели |

### Сетевые параметры

| Переменная | Значение по умолчанию | Описание |
|------------|----------------------|----------|
| `CONTROL_PORT` | `8011` | Порт WebSocket для управления |
| `DATA_PORT` | `8012` | Порт WebSocket для данных |

## Рекомендации по настройке

### Выбор модели
- **tiny**: Самая быстрая, низкое качество
- **base**: Баланс скорости и качества
- **small**: Хорошее качество, умеренная скорость
- **medium**: Высокое качество (по умолчанию)
- **large**: Лучшее качество, медленная

### Настройка чувствительности VAD
- **Низкая чувствительность** (0.01-0.05): Меньше ложных срабатываний
- **Высокая чувствительность** (0.1-0.3): Более быстрая реакция на речь

### Производительность
- Используйте `DEVICE=cpu` если нет GPU
- Уменьшите `BEAM_SIZE` для повышения скорости
- Используйте `tiny` модель для real-time на слабых системах

## Примеры конфигураций

### Максимальная производительность
```env
WHISPER_MODEL=tiny
REALTIME_MODEL_TYPE=tiny
BEAM_SIZE=1
BEAM_SIZE_REALTIME=1
DEVICE=cuda
```

### Максимальное качество
```env
WHISPER_MODEL=large
REALTIME_MODEL_TYPE=base
BEAM_SIZE=10
BEAM_SIZE_REALTIME=5
SILERO_SENSITIVITY=0.03
```

### Для CPU (без GPU)
```env
WHISPER_MODEL=small
REALTIME_MODEL_TYPE=tiny
DEVICE=cpu
BEAM_SIZE=3
```