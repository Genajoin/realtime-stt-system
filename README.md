# üéôÔ∏è Realtime STT System

–°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å –∫–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π —á–µ—Ä–µ–∑ WebSocket.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    WebSocket    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Rich Client   ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ ‚îÇ   Docker GPU Server    ‚îÇ
‚îÇ   (–ª–æ–∫–∞–ª—å–Ω–æ)    ‚îÇ    8011/8012    ‚îÇ     (genaminipc.awg)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                 ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ                                   ‚îÇ
‚îú‚îÄ –ú–∏–∫—Ä–æ—Ñ–æ–Ω                         ‚îú‚îÄ Whisper Medium (769MB)
‚îú‚îÄ Rich –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å                   ‚îú‚îÄ RTX 3090 Ti / CUDA
‚îú‚îÄ WebSocket –∫–ª–∏–µ–Ω—Ç                 ‚îú‚îÄ Real-time —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è
‚îî‚îÄ –ê—É–¥–∏–æ –∑–∞—Ö–≤–∞—Ç                     ‚îî‚îÄ –†—É—Å—Å–∫–∏–π + –∞–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–∞ genaminipc.awg)

```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
cd ~/dev/realtime-stt-system
docker compose down
docker compose build --no-cache  # ~10 –º–∏–Ω—É—Ç –ø–µ—Ä–≤—ã–π —Ä–∞–∑
docker compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker compose ps
docker compose logs -f
```

### 2. –ó–∞–ø—É—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞ (–ª–æ–∫–∞–ª—å–Ω–æ)

```bash
# –ß–µ—Ä–µ–∑ Makefile (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
make run-websocket-client

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
python3 websocket_rich_client.py --server genaminipc.awg
```

## üõ†Ô∏è –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### Makefile –∫–æ–º–∞–Ω–¥—ã

```bash
make help                    # –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã
make run-websocket-client    # –ó–∞–ø—É—Å—Ç–∏—Ç—å WebSocket –∫–ª–∏–µ–Ω—Ç
make deploy                  # –î–µ–ø–ª–æ–π –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
make remote-logs            # –õ–æ–≥–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞
make remote-status          # –°—Ç–∞—Ç—É—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```

### Docker –∫–æ–º–∞–Ω–¥—ã

```bash
# –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
make docker-build           # –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
make docker-run             # –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
make docker-logs            # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
make docker-stop            # –û—Å—Ç–∞–Ω–æ–≤–∫–∞
make docker-status          # –°—Ç–∞—Ç—É—Å –∏ —Ä–µ—Å—É—Ä—Å—ã

# –£–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä  
make deploy                 # –ü–æ–ª–Ω—ã–π –¥–µ–ø–ª–æ–π
make remote-logs            # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å (Docker)

**–ú–æ–¥–µ–ª–∏:**
- **–û—Å–Ω–æ–≤–Ω–∞—è**: Whisper Medium (769MB, –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ)
- **Real-time**: Whisper Tiny (39MB, –±—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–ª–∏–∫)

**–ñ–µ–ª–µ–∑–æ:**
- GPU: RTX 3090 Ti (24GB VRAM)
- CUDA: 12.1
- –ü–æ—Ä—Ç—ã: 8011 (control), 8012 (data)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã** (–≤ `server/Dockerfile`):
```dockerfile
CMD ["python3", "-u", "stt_server.py",
     "--model", "medium",              # Whisper –º–æ–¥–µ–ª—å
     "--language", "ru",               # –†—É—Å—Å–∫–∏–π —è–∑—ã–∫  
     "--realtime_model_type", "tiny",  # Real-time –º–æ–¥–µ–ª—å
     "--device", "cuda",               # GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ
     "--enable_realtime_transcription",
     "--silero_use_onnx"]
```

### –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å

**–ê—É–¥–∏–æ:**
- Sample rate: –∞–≤—Ç–æ–ø–æ–¥–±–æ—Ä (16kHz, 44.1kHz, 48kHz)
- –§–æ—Ä–º–∞—Ç: 16-bit PCM
- –ö–∞–Ω–∞–ª—ã: –º–æ–Ω–æ

**WebSocket:**
- Control: `ws://genaminipc.awg:8011`
- Data: `ws://genaminipc.awg:8012`

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–æ–¥–µ–ª—å | –†–∞–∑–º–µ—Ä | VRAM | –ö–∞—á–µ—Å—Ç–≤–æ | –°–∫–æ—Ä–æ—Å—Ç—å |
|--------|--------|------|----------|----------|
| tiny   | 39MB   | ~1GB | –ë–∞–∑–æ–≤–æ–µ  | –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ |
| small  | 244MB  | ~2GB | –•–æ—Ä–æ—à–µ–µ  | –ë—ã—Å—Ç—Ä–æ |
| **medium** | **769MB** | **~5GB** | **–û—Ç–ª–∏—á–Ω–æ–µ** | **–û–ø—Ç–∏–º–∞–ª—å–Ω–æ** |
| large  | 1.5GB  | ~10GB| –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ | –ú–µ–¥–ª–µ–Ω–Ω–æ |

## üê≥ Docker –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

**6-—Å—Ç–∞–¥–∏–π–Ω–∞—è —Å–±–æ—Ä–∫–∞** —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

1. **pytorch-base**: –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π PyTorch + CUDA (–≥–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑)
2. **system-libs**: –°–∏—Å—Ç–µ–º–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —á–µ—Ä–µ–∑ conda (~200MB, —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è)
3. **heavy-deps**: –ö—Ä—É–ø–Ω—ã–µ Python –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (~1.5GB, —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è)
   - RealtimeSTT, faster-whisper, librosa
4. **light-deps**: –õ–µ–≥–∫–∏–µ Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (~300MB, –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å—Å—è)
5. **runtime-config**: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (~10MB)
6. **production**: –ö–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (~50KB, –∏–∑–º–µ–Ω—è–µ—Ç—Å—è —á–∞—Å—Ç–æ)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ü–µ—Ä–≤–∞—è —Å–±–æ—Ä–∫–∞: ~8 –º–∏–Ω—É—Ç (PyTorch —É–∂–µ –≤ –æ–±—Ä–∞–∑–µ)
- –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞: ~20 —Å–µ–∫—É–Ω–¥
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ª–µ–≥–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π: ~2-3 –º–∏–Ω—É—Ç—ã (—Ç–æ–ª—å–∫–æ —Å—Ç–∞–¥–∏–∏ 4-6)
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç—è–∂–µ–ª—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫: ~5-7 –º–∏–Ω—É—Ç (—Å—Ç–∞–¥–∏–∏ 3-6)
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
ssh genaminipc.awg 'cd ~/dev/realtime-stt-system && docker compose logs -f'

# –°—Ç–∞—Ç—É—Å –∏ —Ä–µ—Å—É—Ä—Å—ã
ssh genaminipc.awg 'cd ~/dev/realtime-stt-system && docker compose ps && docker stats --no-stream'

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU
ssh genaminipc.awg 'nvidia-smi'
```

## üö® Troubleshooting

### –ü—Ä–æ–±–ª–µ–º—ã —Å –∞—É–¥–∏–æ
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–Ω—è—Ç–æ—Å—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
ps aux | grep -E "(python.*stt|python.*rich)" | grep -v grep
kill <PID>  # –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã –ø—Ä–æ—Ü–µ—Å—Å—ã

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞—É–¥–∏–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
python3 -c "import pyaudio; p = pyaudio.PyAudio(); [print(f'{i}: {p.get_device_info_by_index(i)}') for i in range(p.get_device_count())]"
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å Docker
```bash
# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –±–µ–∑ –∫–µ—à–∞
docker compose build --no-cache --progress=plain

# –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
docker system prune -f
docker volume prune -f

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
netstat -tlnp | grep -E ":801[12]"
```

### WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
```bash
# –¢–µ—Å—Ç TCP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
telnet genaminipc.awg 8011

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ curl
curl -I http://genaminipc.awg:8011
```

## üìö API

### WebSocket –ø—Ä–æ—Ç–æ–∫–æ–ª

**Control –∫–∞–Ω–∞–ª** (–ø–æ—Ä—Ç 8011):
- –£–ø—Ä–∞–≤–ª—è—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã
- –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**Data –∫–∞–Ω–∞–ª** (–ø–æ—Ä—Ç 8012):  
- –ü–µ—Ä–µ–¥–∞—á–∞ –∞—É–¥–∏–æ –ø–æ—Ç–æ–∫–∞
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
- Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## üéØ Roadmap

- [ ] Web –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- [ ] API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏
- [ ] –ú–µ—Ç—Ä–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–æ–≤

## üë• Contributing

1. Fork –ø—Ä–æ–µ–∫—Ç–∞
2. –°–æ–∑–¥–∞–π—Ç–µ feature –≤–µ—Ç–∫—É (`git checkout -b feature/amazing-feature`)
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
4. Push –≤ –≤–µ—Ç–∫—É (`git push origin feature/amazing-feature`)
5. –°–æ–∑–¥–∞–π—Ç–µ Pull Request

## üìÑ License

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç MIT License. –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ñ–∞–π–ª–µ `LICENSE`.

---

üöÄ **–ì–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** –ó–∞–ø—É—Å—Ç–∏—Ç–µ `make run-websocket-client` –∏ –Ω–∞—á–Ω–∏—Ç–µ –≥–æ–≤–æ—Ä–∏—Ç—å!