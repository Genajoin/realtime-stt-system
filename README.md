# ๐๏ธ Mic Stream Py - STT Client

ะะปะธะตะฝั ะดะปั ัะฐัะฟะพะทะฝะฐะฒะฐะฝะธั ัะตัะธ ัะตัะตะท OpenAI-ัะพะฒะผะตััะธะผัะน API (Parakeet).

## ๐๏ธ ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    HTTP POST    โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         ะะปะธะตะฝััะบะฐั ัะฐััั        โ โโโโโโโโโโโโโโโบ โ      Parakeet API       โ
โ      (mic_stream_py/client)     โ                 โ    (localhost:5092)     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                 โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ
โโ ะะธะบัะพัะพะฝ (batch ัะตะถะธะผ)
โโ Rich ะธะฝัะตััะตะนั (minimal_editor.py)
โโ ะัะดะธะพ ะฑััะตัะธะทะฐัะธั
โโ HTTP ะบะปะธะตะฝั
โโ ะัะพััะฟะปะฐััะพัะผะตะฝะฝะพััั (Linux/macOS)

ะกัััะบัััะฐ ะฟัะพะตะบัะฐ:
โโโ mic_stream_py/
โ   โโโ client/          # ะะปะธะตะฝััะบะฐั ัะฐััั
โ   โ   โโโ __init__.py
โ   โ   โโโ minimal_editor.py    # TUI ัะตะดะฐะบัะพั
โ   โ   โโโ audio_buffer.py      # ะััะตัะธะทะฐัะธั ะฐัะดะธะพ
โ   โ   โโโ parakeet_client.py   # API ะบะปะธะตะฝั
โ   โ   โโโ voice_daemon.py      # ะคะพะฝะพะฒัะน ัะตัะฒะธั ะณะพะปะพัะพะฒะพะณะพ ะฒะฒะพะดะฐ
โ   โโโ __init__.py
โ   โโโ cli.py
โโโ .env.example
โโโ README.md
```

## ๐ ะัััััะน ััะฐัั

### 1. ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน

#### ะะปั Linux:
```bash
# ะะปะพะฝะธััะตะผ ัะตะฟะพะทะธัะพัะธะน
git clone <repository-url>
cd mic-stream-py

# ะฃััะฐะฝะฐะฒะปะธะฒะฐะตะผ ะทะฐะฒะธัะธะผะพััะธ
pip install -e .

# ะะบัะธะฒะธััะตะผ ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต (ะตัะปะธ ะธัะฟะพะปัะทัะตััั)
source .venv/bin/activate
```

#### ะะปั macOS:
```bash
# ะะปะพะฝะธััะตะผ ัะตะฟะพะทะธัะพัะธะน
git clone <repository-url>
cd mic-stream-py

# ะฃััะฐะฝะฐะฒะปะธะฒะฐะตะผ PortAudio (ะทะฐะฒะธัะธะผะพััั ะดะปั PyAudio)
brew install portaudio

# ะฃััะฐะฝะฐะฒะปะธะฒะฐะตะผ ะทะฐะฒะธัะธะผะพััะธ
pip install -e .

# ะะบัะธะฒะธััะตะผ ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต (ะตัะปะธ ะธัะฟะพะปัะทัะตััั)
source .venv/bin/activate
```

### 2. ะะฐะฟััะบ Parakeet API

ะะตัะตะด ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะบะปะธะตะฝัะฐ ัะฑะตะดะธัะตัั, ััะพ Parakeet API ะทะฐะฟััะตะฝ:

```bash
# ะัะพะฒะตัะบะฐ ะดะพัััะฟะฝะพััะธ API
curl http://localhost:5092/health

# ะะปะธ ะฟัะพะฒะตัััะต ะปะพะณะธ Parakeet
docker logs parakeet-server
```

### 3. ะะฐะฟััะบ ะบะปะธะตะฝัะฐ

```bash
# ะงะตัะตะท CLI
mic-stream

# ะก ัะบะฐะทะฐะฝะธะตะผ API URL
mic-stream --api-url http://localhost:5092/v1

# ะก ัะบะฐะทะฐะฝะธะตะผ ะผะพะดะตะปะธ
mic-stream --model parakeet-tdt-0.6b-v3

# ะขะตััะพะฒัะน ัะตะถะธะผ
mic-stream --test

# ะะปะธ ะฝะฐะฟััะผัั
python3 -m mic_stream_py.cli
```

## ๐ฏ ะัะฟะพะปัะทะพะฒะฐะฝะธะต

1. **F5** - ะะฐัะฐัั ะทะฐะฟะธัั (ะบัะฐัะฝัะน ะธะฝะดะธะบะฐัะพั)
2. ะะพะฒะพัะธัะต ะฒ ะผะธะบัะพัะพะฝ
3. **F5** - ะััะฐะฝะพะฒะธัั ะทะฐะฟะธัั (ะพัะฐะฝะถะตะฒัะน ะธะฝะดะธะบะฐัะพั = ะพัะฟัะฐะฒะบะฐ)
4. ะะพะปััะธัะต ัะตะบัั (ะทะตะปะตะฝัะน ะธะฝะดะธะบะฐัะพั)
5. ะขะตะบัั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะบะพะฟะธััะตััั ะฒ ะฑััะตั

### ะะพัััะธะต ะบะปะฐะฒะธัะธ

| ะะปะฐะฒะธัะฐ | ะะตะนััะฒะธะต |
|---------|----------|
| **F1** | ะะพะบะฐะทะฐัั/ัะบัััั ัะฟัะฐะฒะบั |
| **F5** | ะะฐัะฐัั/ะพััะฐะฝะพะฒะธัั ะทะฐะฟะธัั |
| **F3** | ะะพะฟะธัะพะฒะฐัั ะฒะตัั ัะตะบัั |
| **F8** | ะัะธััะธัั ะฒะตัั ัะตะบัั |
| **Ctrl+A** | ะัะดะตะปะธัั ะฒัะต |
| **Ctrl+C** | ะััะพะด |
| **Ctrl+Q** | ะััะพะด (ะฐะปััะตัะฝะฐัะธะฒะฐ) |
| **ESC** | ะะฐะบัััั ัะฟัะฐะฒะบั |

### ะะฝะดะธะบะฐัะพัั ัะพััะพัะฝะธั

| ะฆะฒะตั | ะกะพััะพัะฝะธะต |
|------|-----------|
| ๐ด ะัะฐัะฝัะน | ะะฐะฟะธัั ะฐัะดะธะพ |
| ๐ ะัะฐะฝะถะตะฒัะน | ะัะฟัะฐะฒะบะฐ ะฝะฐ API |
| ๐ข ะะตะปะตะฝัะน | ะะพัะพะฒ ะบ ัะฐะฑะพัะต |
| โซ ะกะตััะน | ะะตะฐะบัะธะฒะตะฝ |
| โ ะัะฐัะฝัะน (ัะพะฝ) | ะัะธะฑะบะฐ |

## ๐๏ธ ะคะพะฝะพะฒัะน ัะตัะฒะธั ะณะพะปะพัะพะฒะพะณะพ ะฒะฒะพะดะฐ (Daemon)

ะะตะผะพะฝ ะฟะพะทะฒะพะปัะตั ะธัะฟะพะปัะทะพะฒะฐัั ะณะพะปะพัะพะฒะพะน ะฒะฒะพะด ะฒ **ะปัะฑะพะผ ะฟัะธะปะพะถะตะฝะธะธ** ัะตัะตะท ะณะปะพะฑะฐะปัะฝัะน ัะพัะบะตะน.

### ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                  Voice Input Daemon                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  mic-stream trigger (ัะตัะตะท DE ัะพัะบะตะน)                        โ
โ       โ                                                      โ
โ       โผ                                                      โ
โ  [ะะฐะฟะธัั] โโโบ AudioBuffer.start() โโโบ ะทะฒัะบะพะฒะพะน ัะธะณะฝะฐะป       โ
โ       โ                                                      โ
โ       โผ (ะฟะพะฒัะพัะฝัะน trigger)                                  โ
โ  [ะกัะพะฟ] โโโบ AudioBuffer.stop() โโโบ Parakeet API             โ
โ       โ                                                      โ
โ       โผ                                                      โ
โ  ัะตะบัั ะฒ clipboard โโโบ ะทะฒัะบะพะฒะพะน ัะธะณะฝะฐะป โโโบ Ctrl+V ะฒัััะฝัั   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ะฃััะฐะฝะพะฒะบะฐ

```bash
# ะฃััะฐะฝะพะฒะบะฐ Python-ะทะฐะฒะธัะธะผะพััะตะน
pip install -e .

# ะะปั ัะฐะฑะพัั ะฑััะตัะฐ ะพะฑะผะตะฝะฐ (ะพะฑััะฝะพ ัะถะต ัััะฐะฝะพะฒะปะตะฝะพ)
# Wayland: sudo apt install wl-clipboard
# X11: sudo apt install xclip
```

### ะะฐะฟััะบ

```bash
# ะะฐะฟััะบ ะดะตะผะพะฝะฐ
mic-stream daemon

# ะ ะดััะณะพะผ ัะตัะผะธะฝะฐะปะต - ะพัะฟัะฐะฒะธัั ััะธะณะณะตั
mic-stream trigger
```

### ะัะธะฒัะทะบะฐ ะบ ัะพัะบะตัะผ ะฒ DE

**GNOME:**
1. Settings โ Keyboard โ Keyboard Shortcuts โ View and Customize Shortcuts โ Custom Shortcuts
2. Add shortcut:
   - Name: `Voice Input`
   - Command: `/home/user/.venv/bin/mic-stream trigger`
   - Shortcut: `Ctrl+PrtSc`

**KDE:**
1. System Settings โ Shortcuts โ Custom Shortcuts
2. Edit โ New โ Global Shortcut โ Command/URL
3. Trigger: `Ctrl+Print`
4. Action: `/home/user/.venv/bin/mic-stream trigger`

### ะัะฟะพะปัะทะพะฒะฐะฝะธะต

1. ะะฐะถะผะธัะต **Ctrl+PrtSc** โ ะทะฒัะบะพะฒะพะน ัะธะณะฝะฐะป, ะทะฐะฟะธัั ะฝะฐัะฐะปะฐัั
2. ะะพะฒะพัะธัะต ะฒ ะผะธะบัะพัะพะฝ
3. ะะฐะถะผะธัะต **Ctrl+PrtSc** ัะฝะพะฒะฐ โ ะทะฒัะบะพะฒะพะน ัะธะณะฝะฐะป, ัะตะบัั ะฒ ะฑััะตัะต
4. ะะฐะถะผะธัะต **Ctrl+V** ะดะปั ะฒััะฐะฒะบะธ

ะขะตะบัั ะบะพะฟะธััะตััั ะฒ ะฑััะตั ะพะฑะผะตะฝะฐ, ะฒั ะฒััะฐะฒะปัะตัะต ะฒัััะฝัั.

### Systemd ัะตัะฒะธั (ะฐะฒัะพะทะฐะฟััะบ)

ะกะพะทะดะฐะนัะต ัะฐะนะป `~/.config/systemd/user/voice-input.service`:

```ini
[Unit]
Description=Voice Input Daemon
After=graphical-session.target

[Service]
Type=simple
ExecStart=%h/.venv/bin/mic-stream daemon
Restart=on-failure

[Install]
WantedBy=default.target
```

```bash
# ะะบะปััะธัั ะฐะฒัะพะทะฐะฟััะบ
systemctl --user enable voice-input.service
systemctl --user start voice-input.service
```

## ๐ง ะะพะฝัะธะณััะฐัะธั

### ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

ะกะพะทะดะฐะนัะต ัะฐะนะป `.env` ะฒ ัะตะบััะตะน ะดะธัะตะบัะพัะธะธ ะธะปะธ ะดะพะผะฐัะฝะตะน ะฟะฐะฟะบะต:

```bash
# URL Parakeet API
PARAKEET_API_URL=http://localhost:5092/v1

# ะะพะดะตะปั ะดะปั ััะฐะฝัะบัะธะฟัะธะธ
PARAKEET_MODEL=parakeet-tdt-0.6b-v3

# ะฏะทัะบ (ะพะฟัะธะพะฝะฐะปัะฝะพ)
LANGUAGE=auto
```

### ะัะธะพัะธัะตั ะฟะพะธัะบะฐ .env ัะฐะนะปะฐ

1. ะขะตะบััะฐั ะดะธัะตะบัะพัะธั: `./.env`
2. ะะพะผะฐัะฝะธะน ะบะฐัะฐะปะพะณ: `~/.env`
3. ะะผะตะฝะพะฒะฐะฝะฝัะน ัะฐะนะป: `~/mic-stream.env`
4. XDG config: `~/.config/mic-stream/.env`
5. XDG data: `~/.local/share/mic-stream/.env`

## ๐ฆ ะะฐะฒะธัะธะผะพััะธ

### ะัะฝะพะฒะฝัะต
- `pyaudio` โ ะทะฐัะฒะฐั ะฐัะดะธะพ
- `requests` โ HTTP ะทะฐะฟัะพัั
- `prompt_toolkit` โ TUI ะธะฝัะตััะตะนั
- `pyperclip` โ ัะฐะฑะพัะฐ ั ะฑััะตัะพะผ ะพะฑะผะตะฝะฐ

### ะฃััะฐะฝะพะฒะบะฐ

```bash
# ะะธะฝะธะผะฐะปัะฝัะต ะทะฐะฒะธัะธะผะพััะธ
pip install pyaudio requests prompt_toolkit pyperclip

# ะะปะธ ัะตัะตะท setup.py
pip install -e .
```

## โจ ะัะพะฑะตะฝะฝะพััะธ

### ๐๏ธ ะะธะฝะธะผะฐะปะธััะธัะฝัะน ัะตะดะฐะบัะพั
- **ะะะ ะะะะะฎะะะ** - ัะธััะพะต ะบะพะฟะธัะพะฒะฐะฝะธะต ะผะฝะพะณะพัััะพัะฝะพะณะพ ัะตะบััะฐ
- **ะะพะดะดะตัะถะบะฐ ะผััะธ** - ะฒัะดะตะปะตะฝะธะต ัะตะบััะฐ drag & drop
- **ะััะฐะฒะบะฐ ะฒ ะฟะพะทะธัะธั ะบัััะพัะฐ** - ัะตะบัั ะฟะพัะฒะปัะตััั ะณะดะต ะฝัะถะฝะพ
- **ะะฒัะพะบะพะฟะธัะพะฒะฐะฝะธะต ะฒ ะฑััะตั** - ะบะฐะถะดะพะต ัะฐัะฟะพะทะฝะฐะฝะฝะพะต ะฟัะตะดะปะพะถะตะฝะธะต
- **ะะธะฝะธะผะฐะปัะฝัะน ะธะฝัะตััะตะนั** - ัะพะปัะบะพ ัะตะดะฐะบัะพั + ััะฐััั ัััะพะบะฐ
- **ะะฟัะธะผะธะทะธัะพะฒะฐะฝ ะดะปั ะผะฐะปะตะฝัะบะธั ะพะบะพะฝ** - ะธะดะตะฐะปัะฝะพ ะดะปั ัะทะบะธั ัะตัะผะธะฝะฐะปะพะฒ

### ๐ค Batch ัะตะถะธะผ
- ะะฐะฟะธัั โ ะัะฟัะฐะฒะบะฐ โ ะะตะทัะปััะฐั
- 16kHz ะผะพะฝะพ ะฐัะดะธะพ
- ะะฒัะพะผะฐัะธัะตัะบะพะต WAV ะบะพะดะธัะพะฒะฐะฝะธะต
- ะัะพััะฟะปะฐััะพัะผะตะฝะฝะพััั (Linux/macOS)

### ๐ ะะธะฐะณะฝะพััะธะบะฐ
- ะัะพะฒะตัะบะฐ ะดะพัััะฟะฝะพััะธ API ะฟัะธ ะทะฐะฟััะบะต
- ะัะพะฑัะฐะถะตะฝะธะต ะพัะธะฑะพะบ ะฒ ััะฐััั ัััะพะบะต
- ะะฝะดะธะบะฐัะธั ะฒัะตะผะตะฝะธ ะทะฐะฟะธัะธ

## ๐จ Troubleshooting

### PyAudio ะฝะต ัััะฐะฝะฐะฒะปะธะฒะฐะตััั

**Linux:**
```bash
sudo apt-get install portaudio19-dev
pip install pyaudio
```

**macOS:**
```bash
brew install portaudio
pip install pyaudio
```

### ะะธะบัะพัะพะฝ ะฝะต ัะฐะฑะพัะฐะตั

**Linux:**
```bash
# ะัะพะฒะตัััะต ััััะพะนััะฒะฐ
pactl list short sources

# ะัะพะฒะตัััะต ัะฐะทัะตัะตะฝะธั
sudo usermod -a -G audio $USER
```

**macOS:**
- System Preferences โ Security & Privacy โ Privacy โ Microphone
- ะะฐะทัะตัะธัะต ัะตัะผะธะฝะฐะปั ะดะพัััะฟ ะบ ะผะธะบัะพัะพะฝั

### API ะฝะตะดะพัััะฟะตะฝ

```bash
# ะัะพะฒะตัััะต ััะพ Parakeet ะทะฐะฟััะตะฝ
curl http://localhost:5092/health

# ะัะพะฒะตัััะต ะปะพะณะธ
docker logs parakeet-server
```

### ะะตั ัะธััะตะผะฝัั ะทะฒัะบะพะฒ

ะะปะธะตะฝั ะธัะฟะพะปัะทัะตั ัะธััะตะผะฝัะต ะทะฒัะบะธ ะดะปั ัะฒะตะดะพะผะปะตะฝะธะน. ะัะปะธ ะทะฒัะบะธ ะฝะต ัะฐะฑะพัะฐัั:
- Linux: `canberra-gtk-play` (ะพะฑััะฝะพ ะฟัะตะดัััะฐะฝะพะฒะปะตะฝ)
- macOS: ะฒัััะพะตะฝะฝัะต ัะธััะตะผะฝัะต ะทะฒัะบะธ

ะัะปะธ ะทะฒัะบะธ ะฝะตะดะพัััะฟะฝั, ะธัะฟะพะปัะทัะตััั ัะตัะผะธะฝะฐะปัะฝัะน bell (`\a`).

## ๐ API

ะะปะธะตะฝั ะธัะฟะพะปัะทัะตั OpenAI-ัะพะฒะผะตััะธะผัะน ะฟัะพัะพะบะพะป:

```python
from mic_stream_py.client.parakeet_client import ParakeetClient
from mic_stream_py.client.audio_buffer import AudioBuffer

# ะะฝะธัะธะฐะปะธะทะฐัะธั
client = ParakeetClient(api_url="http://localhost:5092/v1")
buffer = AudioBuffer(sample_rate=16000)

# ะะฐะฟะธัั
buffer.start_recording()
# ... ะณะพะฒะพัะธัะต ...
wav_bytes = buffer.stop_recording()

# ะขัะฐะฝัะบัะธะฟัะธั
result = client.transcribe(wav_bytes)
print(result["text"])
```

## ๐ ะะฐะทัะฐะฑะพัะบะฐ

### ะกัััะบัััะฐ ะผะพะดัะปะตะน

- **audio_buffer.py** โ ะทะฐัะฒะฐั ะธ ะฑััะตัะธะทะฐัะธั ะฐัะดะธะพ
- **parakeet_client.py** โ HTTP ะบะปะธะตะฝั ะดะปั API
- **minimal_editor.py** โ TUI ัะตะดะฐะบัะพั
- **cli.py** โ ัะพัะบะฐ ะฒัะพะดะฐ

### ะขะตััะธัะพะฒะฐะฝะธะต

```bash
# ะขะตััะพะฒัะน ัะตะถะธะผ
mic-stream --test

# ะัะพะฒะตัะบะฐ API
python -c "from mic_stream_py.client.parakeet_client import ParakeetClient; c = ParakeetClient(); print(c.health_check())"
```

## ๐ License

MIT License

---

**ะัััััะน ััะฐัั:**
```bash
# 1. ะฃััะฐะฝะพะฒะบะฐ
pip install -e .

# 2. ะะฐะฟััะบ
mic-stream

# 3. F5 โ ะณะพะฒะพัะธัะต โ F5
# 4. ะขะตะบัั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฒ ะฑััะตัะต! ๐ค
```
