# GUI Редактор Транскрипции

## Описание
GUI приложение для редактирования транскрибированного текста в реальном времени. Получает распознанную речь от сервера через WebSocket и позволяет редактировать текст вручную.

## Функции
- ✅ **Полностью автономный** - встроенный захват микрофона, не зависит от других клиентов
- ✅ **Автоматическое подключение** - сразу подключается к серверу при запуске
- ✅ **Автоматическая запись** - начинает запись с микрофона сразу после подключения
- ✅ **Редактирование в реальном времени** - текст добавляется автоматически, можно редактировать
- ✅ **Копирование в буфер** - быстрое копирование всего текста в буфер обмена одной кнопкой
- ✅ **Очистка разговора** - очистка для начала нового разговора
- ✅ **Простой интерфейс** - только нужные кнопки, никаких лишних настроек

## Конфигурация

### Единый конфигурационный файл
Все настройки сервера и GUI клиента находятся в файле `.env`. 

**Для подключения к удаленному серверу:**
1. Скопируй `.env.example` в `.env`:
   ```bash
   cp .env.example .env
   ```

2. Отредактируй параметр `SERVER_HOST` в `.env`:
   ```bash
   # === Настройки GUI клиента ===
   # Адрес сервера для GUI клиента
   SERVER_HOST=genaminipc.awg  # <-- твой IP сервера
   ```

### Переменные окружения
Можно также задать переменные окружения напрямую:
```bash
export SERVER_HOST=genaminipc.awg
export CONTROL_PORT=8011  
export DATA_PORT=8012
```

## Запуск

### Способ 1: С автозагрузкой конфигурации (рекомендуется)
```bash
python3 start_editor.py
# Автоматически загружает настройки из .env файла
```

### Способ 2: Напрямую
```bash
python3 transcription_editor.py
```

### Способ 3: С переменными окружения
```bash
SERVER_HOST=genaminipc.awg python3 transcription_editor.py
```

## Использование

1. **Запуск сервера** (удаленно):
   ```bash
   make deploy  # или на сервере: docker compose up -d
   ```

2. **Запуск GUI редактора**:
   ```bash
   python3 start_editor.py
   ```

3. **Начните говорить**:
   - GUI автоматически начнет запись через микрофон
   - Текст появится в редакторе в реальном времени

3. **Работа с приложением**:
   - Запустите GUI редактор: `python3 start_editor.py`
   - Приложение автоматически подключится к серверу и начнет запись
   - **Просто говорите в микрофон** - текст будет появляться автоматически
   - Редактируйте текст вручную при необходимости
   - Нажмите "Копировать в буфер" для копирования всего текста
   - Нажмите "Очистить" чтобы начать новый разговор

## Особенности

### Интерфейс
- **Информация о сервере**: отображение текущих настроек подключения
- **Статус подключения**: цветовая индикация состояния ("Подключается", "Подключен - говорите")
- **2 кнопки**: "Очистить" (новый разговор) и "Копировать в буфер"
- **Большое текстовое поле**: для комфортного просмотра и редактирования
- **Автоскролл**: автоматическая прокрутка к новому тексту
- **Автозапуск**: никаких лишних действий - просто говорите

### WebSocket соединения
- **Порт 8011**: управляющие команды (старт/стоп записи)
- **Порт 8012**: поток транскрибированного текста

### Обработка ошибок
- Автоматическое переподключение при потере соединения
- Защита от некорректных JSON сообщений
- Пользовательские уведомления об ошибках

## Технические детали

### Архитектура
- **GUI**: Tkinter для кроссплатформенности
- **Асинхронность**: asyncio для WebSocket обработки
- **Многопоточность**: GUI в главном потоке, WebSocket в отдельном

### Зависимости
- `tkinter` (входит в Python)
- `websockets` - для WebSocket соединений
- `pyperclip` - для работы с буфером обмена
- `asyncio` - для асинхронной обработки

### Логирование
Используется стандартный модуль `logging` с уровнем INFO для отладки соединений.

## Устранение проблем

### Не подключается к серверу
1. Убедитесь, что сервер запущен: `python3 server/stt_server.py`
2. Проверьте, что порты 8011 и 8012 свободны
3. Проверьте логи в консоли приложения

### Не слышно звук
1. Проверьте микрофон в системе
2. Убедитесь, что сервер имеет доступ к микрофону
3. Проверьте логи сервера на ошибки PyAudio

### Текст не копируется
1. Убедитесь, что установлен `pyperclip`: `pip install pyperclip`
2. На Linux может потребоваться `xclip` или `xsel`

## Горячие клавиши
- **Ctrl+A** - выделить весь текст
- **Ctrl+C** - копировать выделенный текст
- **Ctrl+V** - вставить текст
- **Ctrl+Z** - отмена последнего действия